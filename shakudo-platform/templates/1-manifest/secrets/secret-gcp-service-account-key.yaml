{{ if .Values.credentials.gcp.enabled }}

{{- $secretObj := (lookup "v1" "Secret" (.Values.defaultNamespace | default "default") "service-account-key-ysivp830") | default dict }}
{{- $secretData := (get $secretObj "data") | default dict }}
{{- $gcpCredentialJsonB64 := (get $secretData "gcp-service-account-credentials.json") | default (.Files.Get .Values.credentials.gcp.hyperplaneServiceAccountJSON | b64enc ) }}

---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-ysivp830
  namespace: {{ .Values.defaultNamespace | default "hyperplane-core" | quote }}
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64 }}

---
apiVersion: v1
kind: Secret
metadata:
  name: hyperplane-gcr-service-account-key
  namespace: hyperplane-core
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64 }}

---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-keycloak-hfdys2v5
  namespace: hyperplane-core
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64 }}

{{- if .Values.components.includeCertManager }}
---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-certmanager-y7pshm5k
  namespace: hyperplane-certmanager
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64 }}
{{ end }}
---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-conda-1w516cz7
  namespace: hyperplane-conda
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64 }}


{{ if .Values.credentials.gcp.clientServiceAccountJSON }}

{{- $secretObj := (lookup "v1" "Secret" "hyperplane-pipelines" "service-account-key-pipelines-dccri9ba") | default dict }}
{{- $secretData := (get $secretObj "data") | default dict }}
{{- $gcpCredentialJsonB64CL := (get $secretData "gcp-service-account-credentials.json") | default (.Files.Get .Values.credentials.gcp.clientServiceAccountJSON | b64enc ) }}

---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-client-ysivp830
  namespace: {{ .Values.defaultNamespace | default "hyperplane-core" | quote }}
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64CL }}
---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-pipelines-dccri9ba
  namespace: hyperplane-pipelines
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64CL }}

---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-jhub-sow17l42
  namespace: hyperplane-jhub
data:
  gcp-service-account-credentials.json: {{ $gcpCredentialJsonB64CL }}

{{ else }}

---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-pipelines-dccri9ba
  namespace: hyperplane-pipelines
data:
  gcp-service-account-credentials.json: ''

---
apiVersion: v1
kind: Secret
metadata:
  name: service-account-key-jhub-sow17l42
  namespace: hyperplane-jhub
data:
  gcp-service-account-credentials.json: ''

{{ end }}

{{ end }}